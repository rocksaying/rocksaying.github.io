---
title: PHP~~JSON in PHP
category: programming
old-category: PHP
tags: [json]
---
<p>
What is JSON (JavaScript Object Notation): <a href="http://www.json.org/" class="outside" target="_blank">Introducing JSON</a>
</p>
<p>
目前已有多種方式可在 PHP 中運用 JSON 。個人建議使用 <a href="http://www.aurore.net/projects/php-json/" class="outside" target="_blank">php-json</a> ，這是 C 語言實作的 PHP extension  。
</p>

<!--more-->
<p>php-json 以 GNU LGPL 條款散佈，目前的 Debian unstable 版本，已經提供了 php-json 的 package 。在作者的網站上，則可以下載原始碼和 win32 版本的 binary ，我在 win32 版本的 PHP5 中使用正常。由於是 native function 的形式，故速度最快，優於其他以 PHP 實作者。但缺點是，並非多數系統預設安裝的 PHP extension ，特別是虛擬主機的用戶，通常不會支援 php-json 。此時只能選擇以 PHP 實作者，例如: <a href="http://pear.php.net/pepr/pepr-proposal-show.php?id=198" class="outside" target="_blank">Services_JSON</a> (BSD license)，或者是<a href="http://framework.zend.com/manual/en/zend.json.html" class="outside" target="_blank">Zend-Json</a> (New BSD license)。
</p>
<p>
使用方法大同小異，都是一對相應函數，以 php-json 為例，即為 json_encode()/json_decode() 。可見作者網站之範例，或如下範例，還有<a href="{{ site.baseurl }}/archives/2006/PHP~~serialize%20and%20unserialize%20with%20Form.html">PHP::serialize and unserialize with Form 的範例</a>。注意， JSON 規範使用 UTF-8 字元，因此在非 UTF-8 環境下，需先用 iconv() 將非 UTF-8 字元轉換成 UTF-8 字元。例如以下的範例，由於沒有調用 iconv() 轉成編碼，在非 UTF-8 環境下，會發生錯誤。如果是在 UTF-8 環境下，就沒有問題。
</p>
<pre class="highlight"><code><span class="cp">&lt;?php</span>
<span class="nv">$ar</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
    <span class="k">array</span><span class="p">(</span>
        <span class="s1">'Name'</span> <span class="o">=&gt;</span> <span class="s1">'涼宮ハルヒン'</span><span class="p">,</span>
        <span class="s1">'Book'</span> <span class="o">=&gt;</span> <span class="s1">'涼宮ハルヒの憂鬱'</span><span class="p">,</span>
        <span class="s1">'Attrib'</span> <span class="o">=&gt;</span> <span class="s1">'SOS団長'</span>
    <span class="p">),</span>
    <span class="k">array</span><span class="p">(</span>
        <span class="s1">'Name'</span> <span class="o">=&gt;</span> <span class="s1">'キョン'</span><span class="p">,</span>
        <span class="s1">'Book'</span> <span class="o">=&gt;</span> <span class="s1">'涼宮ハルヒの憂鬱'</span><span class="p">,</span>
        <span class="s1">'Attrib'</span> <span class="o">=&gt;</span> <span class="s1">'普通人'</span>
    <span class="p">),</span>
    <span class="k">array</span><span class="p">(</span>
        <span class="s1">'Name'</span> <span class="o">=&gt;</span> <span class="s1">'長門有希'</span><span class="p">,</span>
        <span class="s1">'Book'</span> <span class="o">=&gt;</span> <span class="s1">'涼宮ハルヒの憂鬱'</span><span class="p">,</span>
        <span class="s1">'Attrib'</span> <span class="o">=&gt;</span> <span class="s1">'宇宙人'</span>
    <span class="p">),</span>
    <span class="k">array</span><span class="p">(</span>
        <span class="s1">'Name'</span> <span class="o">=&gt;</span> <span class="s1">'朝比奈みくる'</span><span class="p">,</span>
        <span class="s1">'Book'</span> <span class="o">=&gt;</span> <span class="s1">'涼宮ハルヒの憂鬱'</span><span class="p">,</span>
        <span class="s1">'Attrib'</span> <span class="o">=&gt;</span> <span class="s1">'穿越時空的少女'</span>
    <span class="p">),</span>
    <span class="k">array</span><span class="p">(</span>
        <span class="s1">'Name'</span> <span class="o">=&gt;</span> <span class="s1">'古泉一樹'</span><span class="p">,</span>
        <span class="s1">'Book'</span> <span class="o">=&gt;</span> <span class="s1">'涼宮ハルヒの憂鬱'</span><span class="p">,</span>
        <span class="s1">'Attrib'</span> <span class="o">=&gt;</span> <span class="s1">'超能力戰隊少年'</span>
    <span class="p">)</span>
<span class="p">);</span>

<span class="nv">$serialized_ar</span> <span class="o">=</span> <span class="nb">json_encode</span><span class="p">(</span><span class="nv">$ar</span><span class="p">);</span>

<span class="nv">$ar2</span> <span class="o">=</span> <span class="nb">json_decode</span><span class="p">(</span><span class="nv">$serialized_ar</span><span class="p">);</span>

<span class="nb">var_dump</span><span class="p">(</span><span class="nv">$ar2</span><span class="p">);</span>
<span class="cp">?&gt;</span>
</code></pre>

<h6>相關文章</h6>
<ul>
<li><a href="{{ site.baseurl }}/archives/2006/JSON%20in%20PHP%20-%20PHP%205.2%20%E6%AD%A3%E5%BC%8F%E7%B4%8D%E5%85%A5%20JSON%20extension.html">JSON in PHP - PHP 5.2 正式納入 JSON extension</a></li>
<li><a href="{{ site.baseurl }}/archives/2007/Example%20of%20Configuration%20Driven%20Development%20with%20PHP.html">Example of Configuration Driven Development with PHP</a></li>
</ul>
<div class="note">樂多舊網址: <a href="http://blog.roodo.com/rocksaying/archives/1966080.html">http://blog.roodo.com/rocksaying/archives/1966080.html</a></div>