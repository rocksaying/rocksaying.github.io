---
title: 為了Linux與Windows間的網路設定而苦惱
category: life
old-category: 生活記事
tags: [linux,雙ip,網路芳鄰]
---
<div class="tags" style="display:none">Tags: linux 雙IP 網路芳鄰</div>
<p>
最近有個電腦網路的問題讓我非常煩。在 Windows 2k/XP 系統上，要如何在一張實體網路卡上同時設置一個動態IP及一個靜態IP啊？
</p>
<p>
我打算替我這台老舊的電腦 (AMD 1.6G + 512MB RAM, SocketA架構) 做一次最終升級，並計劃趁這機會重灌桌面系統，把Windows XP砍了，回到 <a href="http://www.slackware.org">Slackware Linux</a> 的懷抱。我現在的桌面環境，除了作業系統本身及 IE 之外，已經沒有任何軟體是 Windows-Only 了。可惜我家人的電腦還是要維持 Windows 2k 系統，而且要確保網路芳鄰可以運作。
</p>

<!--more-->
<p>
我的現況是，ADSL 網路，經由 DHCP 配置1個固定IP以及3個不固定IP。家中兩台電腦接在同一台 hub 上，並透過 DHCP 取得IP連接網際網路。另一方面，經由 DHCP 所配置的動態IP並不位於同一個網段上。這表示兩台電腦之間的 TCP/IP 協定封包必須穿過 hub 經由 ISP 的 Gateway 再回擲 hub 後，才能送到對方手上。
</p>
<p>
為了使用網路芳鄰，也為了配合防火牆的安全設置。我切斷了網路芳鄰服務(Microsoft Networks) 與 TCP/IP 協定的連結，限定網路芳鄰服務只能透過 Nwlink 協定傳送封包。由於 Nwlink 協定不具路由能力，是以其封包不會穿過 hub 。於是我可以在區網條件下使用網路芳鄰，也可以連接網際網路。
</p>
<p>
但 Linux 不提供 Nwlink 協定，當我改用 Linux 系統做桌面環境時，就不能延用上面的設定方式了。
</p>
<p>
本來我按照以往的 Linux 網路管理經驗，想在一張實體網路卡上配置兩個IP，一內一外就可以了。實際操作後才發現， Windows 2k/XP 竟然不允許我在啟用 DHCP 後再額外為同一張實體網路卡配置一個靜態IP... 換句話說，如果我不再加一塊實體網路卡，就不能在 Windows 2k/XP 系統上設置雙IP (一個DHCP IP, 一個static IP)。
</p>
<p>
加卡事小，反正我網路卡多的是。接線事大。我可是住老式住宅，牆裡沒埋網路線的。加一張網路卡後，我還要想辦法再拉一條線到hub才行。
</p>
<p>
好吧，老經驗的網管都知道還有一個手段可用。就是把我的 Linux 桌面電腦設定成 Router ，用 NAT 環境。可是這方法我並不想用。我不想只為了讓其中一台電腦上線，就要開啟兩台桌面電腦。很耗電啊。
</p>
<p>
硬體採購預算已經很吃緊了，還要再買一台IP分享器嗎？嗯......
</p><div class="note">樂多舊網址: http://blog.roodo.com/rocksaying/archives/3159507.html</div>
<div class="roodo-comments"><hr/><h6>樂多舊回應</h6>
<blockquote class="roodo-comment">
<div class="roodo-comment-author">zhongmx@gmail.com(zmx) (#comment-10316881)</div>
<div class="roodo-comment-date">Tue, 08 May 2007 22:04:26 +0800</div>
<div class="roodo-comment-text">Try this<br/><a href="http://news.softpedia.com/news/Both-DHCP-and-Static-IP-addresss-at-the-same-time-47494.shtml " rel=\'nofollow\'>Both DHCP and Static IP address at the same time</a><br/>	</div>
</blockquote>
<blockquote class="roodo-comment">
<div class="roodo-comment-author">未留名 (#comment-10319391)</div>
<div class="roodo-comment-date">Tue, 08 May 2007 23:57:12 +0800</div>
<div class="roodo-comment-text">That\'s OK! Thanks very much.<br/><br/>唉，在 Linux/FreeBSD下很簡單的事， Windows 搞的很麻煩，擺明不想讓人用。<br/>	</div>
</blockquote>
<blockquote class="roodo-comment">
<div class="roodo-comment-author">eagle@abpiusa.com(路人) (#comment-10360431)</div>
<div class="roodo-comment-date">Fri, 11 May 2007 00:19:39 +0800</div>
<div class="roodo-comment-text">How about vmware?<br/>	</div>
</blockquote>
<blockquote class="roodo-comment">
<div class="roodo-comment-author">未留名 (#comment-10360945)</div>
<div class="roodo-comment-date">Fri, 11 May 2007 01:27:05 +0800</div>
<div class="roodo-comment-text">Running Linux in a virtual machine of Windows? I would not do that.<br/>	</div>
</blockquote>
</div>
