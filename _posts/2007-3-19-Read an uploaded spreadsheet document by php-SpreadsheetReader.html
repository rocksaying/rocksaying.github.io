---
title: Read an uploaded spreadsheet document by php-SpreadsheetReader
category: programming
old-category: PHP
tags: [php,library]
---
<div class="tags" style="display:none">php library</div>
<p>
In PHP, the global array <a href="http://tw.php.net/manual/en/features.file-upload.php">$_FILES</a> will contain all the uploaded file information. However, the temporary filename of the file in which the uploaded file was stored on the server is not the same as source filename. If you pass the temporary filename to <a href="{{ site.baseurl }}/archives/2007/php-SpreadsheetReader.html">SpreadsheetReaderFactory</a>, it could not detect which reader to suit.
</p>

<!--more-->
<p>
The solution is simple. We simply take the extension name from <var>$_FILES['userfile']['name']</var> and pass it to SpreadsheetReaderFactory. Then we pass <var>$_FILES['userfile']['tmp_name']</var> to reader. That's all.
</p>
<p>
The following is a sample. There is a file field named 'SpreadsheetFile' in the form. PHP will put information of this uploaded file in <var>$_FILES['SpreadsheetFile']</var>.
</p>
<pre class="highlight"><code><span class="cp">&lt;?php</span>
<span class="k">if</span> <span class="p">(</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$_FILES</span><span class="p">[</span><span class="s1">'SpreadsheetFile'</span><span class="p">])</span>
    <span class="k">and</span> <span class="nb">is_uploaded_file</span><span class="p">(</span><span class="nv">$_FILES</span><span class="p">[</span><span class="s1">'SpreadsheetFile'</span><span class="p">][</span><span class="s1">'tmp_name'</span><span class="p">]))</span>
<span class="p">{</span>
	<span class="c1">//print("{$_FILES['SpreadsheetFile']['name']} uploaded.\n");
</span>	<span class="nv">$listFilePath</span> <span class="o">=</span> <span class="nv">$_FILES</span><span class="p">[</span><span class="s1">'SpreadsheetFile'</span><span class="p">][</span><span class="s1">'tmp_name'</span><span class="p">];</span>
	<span class="nv">$listFileExt</span> <span class="o">=</span> <span class="nb">pathinfo</span><span class="p">(</span><span class="nv">$_FILES</span><span class="p">[</span><span class="s1">'SpreadsheetFile'</span><span class="p">][</span><span class="s1">'name'</span><span class="p">],</span> <span class="nx">PATHINFO_EXTENSION</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">require_once</span> <span class="s1">'SpreadsheetReader/SpreadsheetReaderFactory.php'</span><span class="p">;</span>

<span class="nv">$reader</span> <span class="o">=</span> <span class="nx">SpreadsheetReaderFactory</span><span class="o">::</span><span class="na">reader</span><span class="p">(</span><span class="nv">$listFileExt</span><span class="p">);</span>
<span class="nv">$sheets</span> <span class="o">=</span> <span class="nv">$reader</span><span class="o">-&gt;</span><span class="na">read</span><span class="p">(</span><span class="nv">$listFilePath</span><span class="p">);</span>
<span class="cp">?&gt;</span>
</code></pre>
<div class="note">樂多舊網址: http://blog.roodo.com/rocksaying/archives/2878923.html</div>