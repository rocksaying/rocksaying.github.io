---
title: TWPUG問答 - 如何反覆計時執行
category: programming
old-category: PHP
tags: [php]
---
<div class="tags" style="display:none">Tags: php</div>
<p><a href="http://twpug.net/modules/newbb/viewtopic.php?topic_id=2652&forum=13">she96965 問</a>: <q>我想要過三秒後執行一次函數，再過三秒在執行一次，一直反覆一直反覆</q>。
</p>
<p>
答: 用 <a href="http://tw.php.net/manual/en/function.sleep.php">sleep()</a> 。另一方面， PHP 有一個最大執行時間的限制，故尚須配合 <a href="http://tw.php.net/manual/en/function.set-time-limit.php">set_time_limit()</a> 重置最大執行時間的計時。
</p>

<!--more-->
<pre class="highlight"><code><span class="cp">&lt;?php</span>
<span class="k">echo</span> <span class="nb">date</span><span class="p">(</span><span class="s1">'h:i:s'</span><span class="p">)</span> <span class="o">.</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">;</span>
<span class="k">while</span> <span class="p">(</span><span class="kc">true</span><span class="p">)</span> <span class="p">{</span>
    <span class="nb">set_time_limit</span><span class="p">(</span><span class="mi">5</span><span class="p">);</span> <span class="c1">//reset execute time limit, greater than sleep time.
</span>    <span class="nb">sleep</span><span class="p">(</span><span class="mi">3</span><span class="p">);</span>
    <span class="k">echo</span> <span class="nb">date</span><span class="p">(</span><span class="s1">'h:i:s'</span><span class="p">)</span> <span class="o">.</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">;</span>
<span class="p">}</span>
<span class="cp">?&gt;</span>
</code></pre>
<div class="note">樂多舊網址: <a href="http://blog.roodo.com/rocksaying/archives/3407615.html">http://blog.roodo.com/rocksaying/archives/3407615.html</a></div>