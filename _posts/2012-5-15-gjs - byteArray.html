---
title: gjs - byteArray
category: programming
old-category: JavaScript
tags: [gjs,gnome-shell]
---
<p>
在 ECMAScript 規範中，string 資料型別基本是 utf-8 編碼的字元集合，一個字元的資料大小不一定是一個 byte 。用於處理 bytes 資料並不是那麼恰當。
gjs/gnome-shell 另外提供了 byteArray 資料型別，以便更精準地處理位元組資料集合。雖然它不常用。
</p>

<!--more-->
<pre class="highlight"><code>pan class="cp">
#!/usr/bin/gjs
</span><span class="c1">// example of byteArray</span>

<span class="kd">var</span> <span class="nx">a1</span> <span class="o">=</span> <span class="nx">imports</span><span class="p">.</span><span class="nx">byteArray</span><span class="p">.</span><span class="nx">fromArray</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]);</span>

<span class="nx">print</span><span class="p">(</span><span class="nx">a1</span><span class="p">.</span><span class="nx">length</span><span class="p">);</span> <span class="c1">// 3</span>
<span class="nx">print</span><span class="p">(</span><span class="nx">a1</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span> <span class="c1">// 1</span>

<span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">a1</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="o">++</span><span class="nx">i</span><span class="p">)</span>
    <span class="nx">print</span><span class="p">(</span><span class="nx">a1</span><span class="p">[</span><span class="nx">i</span><span class="p">]);</span>


<span class="kd">var</span> <span class="nx">a2</span> <span class="o">=</span> <span class="nx">imports</span><span class="p">.</span><span class="nx">byteArray</span><span class="p">.</span><span class="nx">fromString</span><span class="p">(</span><span class="s1">'hello'</span><span class="p">);</span>

<span class="nx">print</span><span class="p">(</span><span class="nx">a2</span><span class="p">.</span><span class="nx">length</span><span class="p">);</span> <span class="c1">// 5</span>
<span class="nx">print</span><span class="p">(</span><span class="nx">a2</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span> <span class="c1">// 104 (ascii 'h')</span>

<span class="nx">print</span><span class="p">(</span><span class="nx">a2</span><span class="p">.</span><span class="nx">toString</span><span class="p">());</span> <span class="c1">// hello</span>
<span class="k">for</span> <span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">a2</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="o">++</span><span class="nx">i</span><span class="p">)</span>
    <span class="nx">print</span><span class="p">(</span><span class="nx">a2</span><span class="p">[</span><span class="nx">i</span><span class="p">]);</span>

<span class="k">try</span> <span class="p">{</span>
    <span class="nx">a2</span><span class="p">.</span><span class="nx">every</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">v</span><span class="p">,</span> <span class="nx">i</span><span class="p">,</span> <span class="nx">o</span><span class="p">){</span>
        <span class="nx">print</span><span class="p">(</span><span class="nx">v</span><span class="p">);</span>
    <span class="p">});</span>
<span class="p">}</span>
<span class="k">catch</span> <span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">print</span><span class="p">(</span><span class="nx">e</span><span class="p">);</span>
<span class="p">}</span>

</code></pre>


<p>
byteArray 有下列內容:
</p>
<ul>
    <li>fromArray(ar) factory - 以 array 產生 byteArray 的工廠方法。</li>
    <li>fromString(str) factory - 以 string 產生 byteArray 的工廠方法。</li>
    <li>index access operator - 索引存取操作。</li>
    <li>length property - 陣列長度。</li>
    <li>toString method。</li>
</ul>

<p>
byteArray 沒有下列陣列方法:
</p>
<ul>
    <li>push</li>
    <li>pop</li>
    <li>shift</li>
    <li>join</li>
    <li>slice</li>
    <li>indexOf</li>
    <li>every</li>
    <li>forEach</li>
    <li>(等等...)</li>
</ul>

</html><div class="note">樂多舊網址: <a href="http://blog.roodo.com/rocksaying/archives/19465972.html">http://blog.roodo.com/rocksaying/archives/19465972.html</a></div>