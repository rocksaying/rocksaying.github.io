---
title: ASP.Net~~自定控制項的 Property
category: programming
old-category: C/C++/C#/Java
tags: []
permalink: /archives/1690535.html
---
<h1>ASP.Net:: 自定控制項的 Property</h1>
<p>
在自訂控制項類別中，定義 public property 成員，則在 ASPX 頁面標籤中，就可使用相同名稱的標籤屬性(tag attribute)。 ASP.Net 會在 Page_Load() 之前就調用自訂控制項的 property set method ，設定控制項的屬性值。
</p>

<!--more-->
<pre class="highlight"><code><span class="c1">// See also: Visual Studio 2003 .Net Sample Source Code, Duwamish7
//在  modules/viewsourcemodule.ascx.cs 定義 public property 'SourceUrl'
</span><span class="n">namespace</span> <span class="n">Duwamish7</span><span class="p">.</span><span class="n">Web</span>
<span class="p">{</span>
    <span class="n">using</span> <span class="n">System</span><span class="p">;</span>
    <span class="n">using</span> <span class="n">System</span><span class="p">.</span><span class="n">Web</span><span class="p">;</span>
    <span class="n">using</span> <span class="n">System</span><span class="p">.</span><span class="n">Web</span><span class="p">.</span><span class="n">UI</span><span class="p">;</span>
    <span class="n">using</span> <span class="n">System</span><span class="p">.</span><span class="n">Web</span><span class="p">.</span><span class="n">UI</span><span class="p">.</span><span class="n">WebControls</span><span class="p">;</span>
    <span class="n">using</span> <span class="n">System</span><span class="p">.</span><span class="n">Collections</span><span class="p">;</span>
    <span class="n">using</span> <span class="n">System</span><span class="p">.</span><span class="n">ComponentModel</span><span class="p">;</span>
    <span class="n">using</span> <span class="n">System</span><span class="p">.</span><span class="n">Data</span><span class="p">;</span>

    <span class="n">public</span> <span class="n">class</span> <span class="n">ViewSourceModule</span> <span class="o">:</span> <span class="n">ModuleBase</span>
    <span class="p">{</span>
        <span class="n">protected</span> <span class="n">System</span><span class="p">.</span><span class="n">Web</span><span class="p">.</span><span class="n">UI</span><span class="p">.</span><span class="n">WebControls</span><span class="p">.</span><span class="n">HyperLink</span> <span class="n">SourceHyperLink</span><span class="p">;</span>
        <span class="n">protected</span> <span class="kt">void</span> <span class="nf">Page_Load</span><span class="p">(</span><span class="n">Object</span> <span class="n">sender</span><span class="p">,</span> <span class="n">EventArgs</span> <span class="n">e</span><span class="p">)</span>
        <span class="p">{</span>
        <span class="p">}</span>

        <span class="c1">/// &lt;value&gt;
</span>        <span class="c1">///     Property SourceUrl is used to set the URL of the hyperlink for source viewing.
</span>        <span class="c1">/// &lt;/value&gt;
</span>        <span class="n">public</span> <span class="n">String</span> <span class="n">SourceUrl</span>
        <span class="p">{</span>
            <span class="n">set</span>
            <span class="p">{</span>
                <span class="n">SourceHyperLink</span><span class="p">.</span><span class="n">NavigateUrl</span> <span class="o">=</span> <span class="n">PageBase</span><span class="p">.</span><span class="n">UrlBase</span> <span class="o">+</span> <span class="s">"/"</span> <span class="o">+</span> <span class="n">value</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>

    <span class="p">}</span> <span class="c1">// class ViewSourceModule
</span><span class="p">}</span> <span class="c1">// namespace Duwamish7.Web
</span></code></pre>

<hr/>
<pre class="highlight"><code><span class="o">&lt;%</span><span class="err">@</span> <span class="n">Page</span> <span class="n">Language</span><span class="o">=</span><span class="s">"c#"</span> <span class="n">Codebehind</span><span class="o">=</span><span class="s">"Default.aspx.cs"</span> <span class="n">AutoEventWireup</span><span class="o">=</span><span class="s">"false"</span> <span class="n">Inherits</span><span class="o">=</span><span class="s">"Duwamish7.Web.Default"</span>  <span class="n">EnableSessionState</span><span class="o">=</span><span class="s">"true"</span> <span class="o">%&gt;</span>
<span class="o">&lt;%</span><span class="err">@</span> <span class="n">Register</span> <span class="n">TagPrefix</span><span class="o">=</span><span class="s">"Module"</span> <span class="n">TagName</span><span class="o">=</span><span class="s">"ViewSource"</span> <span class="n">Src</span><span class="o">=</span><span class="s">"modules/viewsourcemodule.ascx"</span> <span class="o">%&gt;</span>
<span class="o">&lt;</span><span class="n">Module</span><span class="o">:</span><span class="n">ViewSource</span> <span class="n">id</span><span class="o">=</span><span class="s">"ModuleViewSource"</span>
	<span class="n">SourceUrl</span><span class="o">=</span><span class="s">"viewsource.aspx?path=default.src"</span>
	<span class="n">runat</span><span class="o">=</span><span class="s">"server"</span><span class="o">&gt;</span>
<span class="o">&lt;/</span><span class="n">Module</span><span class="o">:</span><span class="n">ViewSource</span><span class="o">&gt;</span>
</code></pre>

<p>
注意，如果自定控制項的 property 內容有使用到執行時期，例如 Page_Load() 中才建構的實例，那麼在頁面中設定標籤屬性的用法，將發生執行時期的例外。因為 ASP.Net 會在 Page_Load() 之前就先呼叫控制項的 property set method。
</p><div class="note">樂多舊網址: http://blog.roodo.com/rocksaying/archives/1690535.html</div>